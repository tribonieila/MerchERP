{{extend 'layout.html'}}
<div class="col-md-12">
    <div class="card card-underline">
        <div class="card-head">
            <ul class="nav nav-tabs pull-right" data-toggle="tabs">
                <li class="active"><a href="#">EDIT</a></li>
                <li class=""><a href="#" onclick=window.location="{{=URL('itm_mas')}}";>BROWSE</a></li>
            </ul>
            <span class="card-title">ITEM MASTER FORM</span>
        </div>
        <div class="card-body tab-content">
            <!-- {{=form}} -->
            {{=form.custom.begin}}					
            <div class="form-horizontal">   
                 <div class="form-group">
                    <label class="col-sm-1 control-label">Item Code</label>
                    <div class="col-sm-2"><input type="text" class="form-control" name="item_code" id="item_code" value="{{=_fld.item_code}}" readonly>
                    <p class="help-block">autogenerate</p></div> 
                    <label class="col-sm-1 control-label">Description</label>
                    <div class="col-sm-2">{{=form.custom.widget.item_description}}</div>    
                    <label class="col-sm-1 control-label">Arabic Description</label>
                    <div class="col-sm-2">{{=form.custom.widget.item_description_ar}}</div>
                    <label class="col-sm-1 control-label">Supplier Item Reference</label>
                    <div class="col-sm-2">{{=form.custom.widget.supplier_item_ref}}</div>
                </div>    
                <div class="form-group">
                    <label class="col-sm-1 control-label">International Barcode</label>
                    <div class="col-sm-2">{{=form.custom.widget.int_barcode}}</div>
                    <label class="col-sm-1 control-label">Local Barcode</label>
                    <div class="col-sm-2">{{=form.custom.widget.loc_barcode}}</div>
                    <label class="col-sm-1 control-label">Purchase Point</label>
                    <div class="col-sm-1">{{=form.custom.widget.purchase_point}}</div>
                    <label class="col-sm-2 control-label">Selective Tax</label>
                    <div class="col-sm-1">{{=form.custom.widget.selectivetax}}</div>
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Vat Percentage</label>
                    <div class="col-sm-1">{{=form.custom.widget.vatpercentage}}</div>
                    <label class="col-sm-2 control-label">Item Type</label>
                    <div class="col-sm-2">{{=form.custom.widget.type_id}}</div>
                    <label class="col-sm-1 control-label">UOM Value</label>
                    <div class="col-sm-1"><input type="text" class="form-control" name="uom_value" id="uom_value" value="{{=_fld.uom_value}}" readonly></div><div class="col-sm-1"><input type="text" class="form-control" name="uom_value" id="uom_value" value="{{=_fld.uom_id.description}}" readonly></div>
                    <label class="col-sm-1 control-label">Supplier UOM</label>
                    <div class="col-sm-1">{{=form.custom.widget.supplier_uom_value}}</div><div class="col-sm-1">{{=form.custom.widget.supplier_uom_id}}</div>
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Weight Value</label>
                    <div class="col-sm-1">{{=form.custom.widget.weight_value}}</div>
                    <div class="col-sm-1">{{=form.custom.widget.weight_id}}</div>
                    <label class="col-sm-1 control-label">Division</label><div class="col-sm-2">{{=form.custom.widget.division_id}}</div> 
                    <label class="col-sm-1 control-label">Department</label><div class="col-sm-2">{{=form.custom.widget.dept_code_id}}</div> 
                    <label class="col-sm-1 control-label">Supplier</label><div class="col-sm-2">{{=form.custom.widget.supplier_code_id}}</div> 
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Product</label>
                    <div class="col-sm-2">{{=form.custom.widget.product_code_id}}</div>
                    <label class="col-sm-1 control-label">Sub-Product</label>
                    <div class="col-sm-2">{{=form.custom.widget.subproduct_code_id}}</div>
                    <label class="col-sm-1 control-label">Group Line</label>
                    <div class="col-sm-2">{{=form.custom.widget.group_line_id}}</div>
                    <label class="col-sm-1 control-label">Brand Line</label>
                    <div class="col-sm-2">{{=form.custom.widget.brand_line_code_id}}</div>
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Brand Classfication</label>
                    <div class="col-sm-2">{{=form.custom.widget.brand_cls_code_id}}</div>
                    <label class="col-sm-1 control-label">Section</label>
                    <div class="col-sm-2">{{=form.custom.widget.section_code_id}}</div>
                    <label class="col-sm-1 control-label">Size</label>
                    <div class="col-sm-2">{{=form.custom.widget.size_code_id}}</div>
                    <label class="col-sm-1 control-label">Gender</label>
                    <div class="col-sm-2">{{=form.custom.widget.gender_code_id}}</div>
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Fragrance Code</label>
                    <div class="col-sm-2">{{=form.custom.widget.fragrance_code_id}}</div>
                    <label class="col-sm-1 control-label">Color</label>
                    <div class="col-sm-2">{{=form.custom.widget.color_code_id}}</div>
                    <label class="col-sm-1 control-label">Collection</label>
                    <div class="col-sm-2">{{=form.custom.widget.collection_code_id}}</div>
                    <label class="col-sm-1 control-label">Made In</label>
                    <div class="col-sm-2">{{=form.custom.widget.made_in_id}}</div>
                </div>                    
                <div class="form-group">
                    <label class="col-sm-1 control-label">Item Status</label>
                    <div class="col-sm-2">{{=form.custom.widget.item_status_code_id}}</div>
                    <label class="col-sm-1 control-label"></label>
                    <div class="col-sm-2">
                        {{=form.custom.submit}}
                        <input class="btn btn-primary" type="button" value="Next" onclick="onNext()" >
                    </div>
                    
                </div>                                    
            </div>
            {{=form.custom.end}} 
    </div>
        
        </div> 
    </div>
<script src="{{=URL('static','js/cascade.js')}}"></script>
<script type="text/javascript">    
    $('#Item_Master_uom_value').prop('readonly', true);
    $('#Item_Master_uom_id').attr("disabled", true); 
        
    function onNext(){        
        window.location.href='{{=URL('inventory','item_prices_edit', args = request.args(0))}}'
    }
    jQuery(document).ready(function($){

        var data = [ {{for g in db((db.Sub_Group_Line.status_id == 1) & (db.Sub_Group_Line.supplier_code_id == _fld.supplier_code_id)).select(db.GroupLine.ALL, db.Sub_Group_Line.ALL, left = db.Sub_Group_Line.on(db.GroupLine.id == db.Sub_Group_Line.group_line_code_id)):}}
            { text: '{{=g.GroupLine.group_line_code}} - {{=g.GroupLine.group_line_name}}', value: '{{=g.GroupLine.id}}',
                children: [ {{for b in db((db.Brand_Line.status_id == 1) & (db.Brand_Line.group_line_id == g.GroupLine.id)).select(db.Brand_Line.ALL):}}
                    { text: '{{=b.brand_line_code}} - {{=b.brand_line_name}}', value: '{{=b.id}}',
                        children: [ {{for c in db((db.Brand_Classification.status_id == 1) & (db.Brand_Classification.brand_line_code_id == b.id)).select(db.Brand_Classification.ALL):}}
                            { text: '{{=c.brand_cls_code}} - {{=c.brand_cls_name}}', value: '{{=c.id}}'}, {{pass}}
                        ],
                    }, {{pass}}
                ], 
            }, {{pass}}
        ];
        $('#Item_Master_group_line_id').cascadingSelect({
            subSelects: ['#Item_Master_brand_line_code_id','#Item_Master_brand_cls_code_id'],
            data: data
        });
    }); 
</script>
<script>
    jQuery(document).ready(function($){
        var data2 = [ 
            { text: 'Choose Division', value: null},
            {{for v in db(db.Division.status_id == 1).select(db.Division.ALL):}}            
            { text: '{{=v.div_code}} - {{=v.div_name}}', value: '{{=v.id}}',
                children: [ { text: 'Choose Product', value: null}, {{for pr in db((db.Product.status_id == 1) & (db.Product.div_code_id == v.id)).select(db.Product.ALL):}} 
                            { text:'{{=pr.product_code}} - {{=pr.product_name}}', value:'{{=pr.id}}',
                    children: [ { text: 'Choose Sub-Product', value: null}, {{for sp in db((db.SubProduct.status_id == 1) & (db.SubProduct.product_code_id == pr.id)).select(db.SubProduct.ALL):}}
                                { text: '{{=sp.subproduct_code}} - {{=sp.subproduct_name}}', value: '{{=sp.id}}'}, {{pass}}
                            ],
                    }, {{pass}}
                ],
            }, {{pass}}
        ];        

        $('#Item_Master_division_id').cascadingSelect({
            subSelects: ['#Item_Master_product_code_id','#Item_Master_subproduct_code_id'],
            data: data2
        });    
    });

</script>